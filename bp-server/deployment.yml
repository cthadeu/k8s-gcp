apiVersion: v1
kind: ConfigMap
metadata:
  name: bp-server-config
  namespace: prod-sc
data:
  HSM_HOST: "3.80.50.14"
  HSM_PORT: "3000"
  SERVER_PORT: "8090"
  SERVER_CONFIG: "PROD"
  REDIS_PORT: "6379"
  SERVER_DEBUG: "false"
  SERVER_LOCATION: "HSM_CLOUD_SC"
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: bp-server
  namespace: prod-sc
spec:
  replicas: 2
  selector:
    matchLabels:
      app: bp-server
  template:
    metadata:
      labels:
        app: bp-server
    spec:
      containers:
        - name: bp-server
          image: cthadeu/bpserver:0.7.5 # Substitua pela imagem correta
          ports:
            - containerPort: 8090
              protocol: TCP
          envFrom:
            - configMapRef:
                name: bp-server-config
      imagePullSecrets:
        - name: cthadeu-dockerhub
---
apiVersion: v1
kind: Service
metadata:
  name: bp-server-service
  namespace: prod-sc
spec:
  selector:
    app: bp-server
  ports:
    - protocol: TCP
      port: 8090 # Porta exposta pelo servi√ßo
      targetPort: 8090 # Porta do container
  type: LoadBalancer # Pode ser LoadBalancer ou NodePort, dependendo do seu cluster

